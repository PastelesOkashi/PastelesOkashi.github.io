<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pasteles Okashi</title>
    <link rel="stylesheet" href="nav.css">
    <link rel="stylesheet" href="general.css">
    <link rel="stylesheet" href="clases.css">
    <link rel="stylesheet" href="template.css">
    <link rel="shortcut icon" href="img/logo.png" type="image/x-icon">
    <script>
        var nn = "display:none;";
        var gr = "display:grid;";
        var bl = "display: block;";
        function he1(id){// de help ayuda
            return document.getElementById(id)
        }
        function Dproductos(){
            he1("c2").setAttribute("style", nn);
            he1("c3").setAttribute("style", nn);
            he1("c4").setAttribute("style", nn);

            he1("c1").setAttribute("style", bl);
        }
        function Dcontacto(){
            he1("c1").setAttribute("style", nn);
            he1("c3").setAttribute("style", nn);
            he1("c4").setAttribute("style", nn);

            he1("c2").setAttribute("style", gr)
        }
        function Dvision(){
            he1("c1").setAttribute("style", nn);
            he1("c2").setAttribute("style", nn);
            he1("c4").setAttribute("style", nn);

            he1("c3").setAttribute("style", bl);
        }
        function Dnosotros(){
            he1("c1").setAttribute("style", nn);
            he1("c3").setAttribute("style", nn);
            he1("c2").setAttribute("style", nn);

            he1("c4").setAttribute("style", bl);
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        // Variables
        const baseDeDatos = [
            {
                id: 1,
                nombre: 'Patata',
                precio: 1,
                imagen: 'img/baumkuchen.jpg'
            },
            {
                id: 2,
                nombre: 'Cebolla',
                precio: 1.2,
                imagen: 'img/cheesecake.jpg'
            },
            {
                id: 3,
                nombre: 'Calabacin',
                precio: 2.1,
                imagen: 'img/daifuku.jpg'
            },
            {
                id: 4,
                nombre: 'Fresas',
                precio: 0.6,
                imagen: 'img/dango.jpg'
            }

        ];

        let carrito = [];
        const divisa = '€';
        const DOMitems = document.querySelector('#items');
        const DOMcarrito = document.querySelector('#carrito');
        const DOMtotal = document.querySelector('#total');
        const DOMbotonVaciar = document.querySelector('#boton-vaciar');

        // Funciones

        /**
         * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
         */
        function renderizarProductos() {
            baseDeDatos.forEach((info) => {
                // Estructura
                const miNodo = document.createElement('div');
                miNodo.classList.add('card', 'col-sm-4');
                // Body
                const miNodoCardBody = document.createElement('div');
                miNodoCardBody.classList.add('card-body');
                // Titulo
                const miNodoTitle = document.createElement('h5');
                miNodoTitle.classList.add('card-title');
                miNodoTitle.textContent = info.nombre;
                // Imagen
                const miNodoImagen = document.createElement('img');
                miNodoImagen.classList.add('img-fluid');
                miNodoImagen.setAttribute('src', info.imagen);
                // Precio
                const miNodoPrecio = document.createElement('p');
                miNodoPrecio.classList.add('card-text');
                miNodoPrecio.textContent = `${info.precio}${divisa}`;
                // Boton 
                const miNodoBoton = document.createElement('button');
                miNodoBoton.classList.add('btn', 'btn-primary');
                miNodoBoton.textContent = '+';
                miNodoBoton.setAttribute('marcador', info.id);
                miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);
                // Insertamos
                miNodoCardBody.appendChild(miNodoImagen);
                miNodoCardBody.appendChild(miNodoTitle);
                miNodoCardBody.appendChild(miNodoPrecio);
                miNodoCardBody.appendChild(miNodoBoton);
                miNodo.appendChild(miNodoCardBody);
                DOMitems.appendChild(miNodo);
            });
        }

        /**
         * Evento para añadir un producto al carrito de la compra
         */
        function anyadirProductoAlCarrito(evento) {
            // Anyadimos el Nodo a nuestro carrito
            carrito.push(evento.target.getAttribute('marcador'))
            // Actualizamos el carrito 
            renderizarCarrito();

        }

        /**
         * Dibuja todos los productos guardados en el carrito
         */
        function renderizarCarrito() {
            // Vaciamos todo el html
            DOMcarrito.textContent = '';
            // Quitamos los duplicados
            const carritoSinDuplicados = [...new Set(carrito)];
            // Generamos los Nodos a partir de carrito
            carritoSinDuplicados.forEach((item) => {
                // Obtenemos el item que necesitamos de la variable base de datos
                const miItem = baseDeDatos.filter((itemBaseDatos) => {
                    // ¿Coincide las id? Solo puede existir un caso
                    return itemBaseDatos.id === parseInt(item);
                });
                // Cuenta el número de veces que se repite el producto
                const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                    // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo
                    return itemId === item ? total += 1 : total;
                }, 0);
                // Creamos el nodo del item del carrito
                const miNodo = document.createElement('li');
                miNodo.classList.add('list-group-item', 'text-right', 'mx-2');
                miNodo.textContent = `${numeroUnidadesItem} x ${miItem[0].nombre} - ${miItem[0].precio}${divisa}`;
                // Boton de borrar
                const miBoton = document.createElement('button');
                miBoton.classList.add('btn', 'btn-danger', 'mx-5');
                miBoton.textContent = 'X';
                miBoton.style.marginLeft = '1rem';
                miBoton.dataset.item = item;
                miBoton.addEventListener('click', borrarItemCarrito);
                // Mezclamos nodos
                miNodo.appendChild(miBoton);
                DOMcarrito.appendChild(miNodo);
            });
            // Renderizamos el precio total en el HTML
            DOMtotal.textContent = calcularTotal();
        }

        /**
         * Evento para borrar un elemento del carrito
         */
        function borrarItemCarrito(evento) {
            // Obtenemos el producto ID que hay en el boton pulsado
            const id = evento.target.dataset.item;
            // Borramos todos los productos
            carrito = carrito.filter((carritoId) => {
                return carritoId !== id;
            });
            // volvemos a renderizar
            renderizarCarrito();
        }

        /**
         * Calcula el precio total teniendo en cuenta los productos repetidos
         */
        function calcularTotal() {
            // Recorremos el array del carrito 
            return carrito.reduce((total, item) => {
                // De cada elemento obtenemos su precio
                const miItem = baseDeDatos.filter((itemBaseDatos) => {
                    return itemBaseDatos.id === parseInt(item);
                });
                // Los sumamos al total
                return total + miItem[0].precio;
            }, 0).toFixed(2);
        }

        /**
         * Varia el carrito y vuelve a dibujarlo
         */
        function vaciarCarrito() {
            // Limpiamos los productos guardados
            carrito = [];
            // Renderizamos los cambios
            renderizarCarrito();
        }

        // Eventos
        DOMbotonVaciar.addEventListener('click', vaciarCarrito);

        // Inicio
        renderizarProductos();
        renderizarCarrito();
        });
    </script>
</head>
<body>
    <div class="principal">

        <div class="entrada">
            <h1>Pasteles Okashi</h1>
            <h3>Dulces japoneses, símbolo de perfección y belleza.</h3>
        </div>

<!--.......................................................................................... -->
        <div class="productos templateCords" id="c1">
            <h1 class="titulo">Productos</h1>
            <div class="prod">

                <h1 class="titulo tit1">Baumkuchen</h1>
                <img src="img/baumkuchen.png" class="i1">
                <p class="p1">
                    <span>Descripción:</span><br><br>Está formado por capas finas y se acompaña con helado y chocolate caliente por encima.

                </p>

                <div class="brd1"><h1 class="titulo">Cheesecake japonés</h1></div>

                <img src="img/cheesecake.jpg" class="i2">
                <p class="p2">
                    <span>Descripción:</span><br><br>Bizcocho muy suave y esponjoso.
                </p>

                <div class="brd2"><h1 class="titulo">Daifuku</h1></div>

                <img src="img/daifuku.png" class="i3">
                <p class="p3">
                    <span>Descripción:</span><br><br>Conocido como “Mochi”, dulce popular en Japón. Relleno con judía roja. 
                </p>

                <div class="brd3"><h1 class="titulo">Dango</h1></div>

                <img src="img/dango.png" class="i4">
                <p class="p4">
                    <span>Descripción:</span><br><br>Bolitas de harina de arroz, de distintos colores.
                </p>

                <div class="brd4"><h1 class="titulo">Dorayaki</h1></div>

                <img src="img/dorayaki.png" class="i5">
                <p class="p5">
                    <span>Descripción:</span><br><br>Bizcocho relleno con pasta de judías rojas.
                </p>

                <div class="brd5"><h1 class="titulo">Namagashi</h1></div>

                <img src="img/namagashi.jpg" class="i6">
                <p class="p6">
                    <span>Descripción:</span><br><br>Dulce agradable visualmente que se diseña según la estación del año.
                </p>

                <div class="brd6"><h1 class="titulo">Swiss Rolls</h1></div>

                <img src="img/Swiss.png" class="i7">
                <p class="p7">
                    <span>Descripción:</span><br><br>Es un pastel alargado, enrollado y relleno. Arriba  se le pone mermelada o chocolate. 
                </p>

                <div class="brd7"><h1 class="titulo">Taiyaki</h1></div>

                <img src="img/taiyaki.png" class="i8">
                <p class="p8">
                    <span>Descripción:</span><br><br>Pastel en forma de pez, relleno con judías rojas o también una bola de helado. 
                </p>


            </div>
        </div>

        <div class="local templateCords" id="c2">

            <div class="mapa">
                <h1>Mapa</h1>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3327.5128331988144!2d-70.656235485046!3d-33.48803218076314!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662c5331ed1296d%3A0x43cf8476e77bcb23!2sRey%20Alberto%203799%2C%208910166%20San%20Miguel%2C%20Regi%C3%B3n%20Metropolitana!5e0!3m2!1ses-419!2scl!4v1667196779858!5m2!1ses-419!2scl" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
            <div class="ig">
                <h1 class="titulo">Síguenos en Instagram</h1>
                <a href="https://www.instagram.com/pasteleria.okashi_/" target="_blank">
                    <img src="img/instagram.png">
                </a>
            </div>
        </div>

        <div class="vision templateCords" id="c3">
            <h1 class="titulo">Visión y Misión</h1>
            <div class="myv">
                <p>
                    La misión de okashi es brindar el mejor servicio, valor y experiencia a nuestros clientes
                     y así puedan adquirir  una parte de esta exquisita pastelería japonesa respetando su tradición 
                     y con esto lograr nuestra visión de ser el mejor  local de pastelería japonesa a nivel país.
                </p>
            </div>
        </div> 

        <div class="nosotros templateCords" id="c4">
            <h1 class="titulo">Nosotros</h1>
            <div class="nosP">
                <p>
                    Pasteles Okashi, es el proyecto decidido ya que nos agrada la realización de distintos tipos de dulces y 
                    más si es del estilo japonés, por su delicadeza y por el impacto visual que da al público. Tener un local 
                    que ofrezca y donde se realice distintos tipos de dulces japonés no es tan común, ya que son dulces 
                    y pasteles del estilo clásico japonés, aunque además se puede hacer pasteles temáticos si el cliente 
                    lo solicita. Nos gusta también tener un negocio el cual no necesite de tanto personal ni un espacio 
                    enorme donde poder realizar todo. 
                </p>
            </div>
        </div>
<!--.......................................................................................... -->
        
        <div class="container">
            <div class="row">
                <!-- Elementos generados a partir del JSON -->
                <main id="items" class="col-sm-8 row"></main>
                <!-- Carrito -->
                <aside class="col-sm-4">
                    <h2>Carrito</h2>
                    <!-- Elementos del carrito -->
                    <ul id="carrito" class="list-group"></ul>
                    <hr>
                    <!-- Precio total -->
                    <p class="text-right">Total: <span id="total"></span>&euro;</p>
                    <button id="boton-vaciar" class="btn btn-danger">Vaciar</button>
                </aside>
            </div>
        </div>

        <div class="nav1">
            <nav class="navMenu">
                <ul>
                    <li><a onclick="Dproductos()" href="#c1">Productos</a></li>
                    <li><a onclick="Dcontacto()" href="#c2">Contacto</a></li>
                    <li><a onclick="Dvision()" href="#c3">Visión y misión</a></li>
                    <li><a onclick="Dnosotros()" href="#c4">Nosotros</a></li>
                </ul>
            </nav>
        </div>
        
    </div>
</body>
</html>